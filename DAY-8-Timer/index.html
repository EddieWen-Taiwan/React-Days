<!DOCTYPE html>
<html>
<head>

	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />

	<meta name="description" content="React.js library" />
	<meta name="author" content="EddieWen | 温奕書" />
	<meta name="URL" content="http://github.eddiewen.me/React-Days/DAY-8-Timer/" />
	<meta name="image" content="https://facebook.github.io/react/img/logo_og.png" />

	<!-- Open Graph -->
	<meta property="og:site_name" content="React Timer" />
	<meta property="og:title" content="React Timer" />
	<meta property="og:type" content="website" />
	<meta property="og:url" content="http://github.eddiewen.me/React-Days/DAY-8-Timer/"  />
	<meta property="og:image" content="https://facebook.github.io/react/img/logo_og.png" />
	<meta property="og:description" content="React.js library" />

	<title>React Timer</title>
	<link rel="Shortcut Icon" type="image/x-icon" href="https://facebook.github.io/react/img/logo_og.png" />

	<!-- React.js -->
	<script type="text/javascript" src="../library/react.min.js"></script>
	<script type="text/javascript" src="../library/react-dom.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.6.15/browser.js"></script>

	<!-- my CSS -->
	<style type="text/css">
	#now,.title{font-weight:700}#now,.btn{text-align:center}body{margin:0;padding:0;color:#000;background-color:#9E9E9E;font-family:"Helvetica Neue";-webkit-transition:all .5s;-moz-transition:all .5s;-o-transition:all .5s;transition:all .5s}#container{width:100vw;height:100vh;overflow:hidden}#container>div{width:100%}#now{font-size:120px;letter-spacing:5px;text-shadow:0 1px 0 #fff,0 -1px 0 #fff,1px 0 0 #fff,-1px 0 0 #fff}.v-mid{display:-webkit-flex;display:-ms-flexbox;display:-moz-box;display:flex;-webkit-align-items:center;-moz-align-items:center;-ms-align-items:center;align-items:center}#card{width:450px;height:400px;border-radius:10px;position:fixed;top:100px;left:50%;margin-left:-225px;background-color:#fff;box-shadow:0 3px 7px rgba(0,0,0,.5)}.title{width:90%;padding:50px 5% 10px;border-radius:10px 10px 0 0;background-color:#FFEB3B;color:#424242;font-size:24px}h5{margin-left:5%;color:rgba(0,0,0,.54)}.btn{width:70px;padding:10px 0;margin:50px auto 0;color:#fff;background-color:#727272;border-radius:3px;cursor:pointer}.animated{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-fill-mode:both;animation-fill-mode:both}.animated.fadeOutUp{-webkit-animation-duration:.5s;animation-duration:.5s}.animated.infinite{-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite}@-webkit-keyframes shake{from,to{-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}10%,30%,50%{-webkit-transform:translate3d(-20px,0,0);transform:translate3d(-20px,0,0)}20%,40%,60%{-webkit-transform:translate3d(20px,0,0);transform:translate3d(20px,0,0)}}@keyframes shake{from,to{-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}10%,30%,50%{-webkit-transform:translate3d(-20px,0,0);transform:translate3d(-20px,0,0)}20%,40%,60%{-webkit-transform:translate3d(20px,0,0);transform:translate3d(20px,0,0)}}.shake{-webkit-animation-name:shake;animation-name:shake}@-webkit-keyframes fadeOutUp{from{opacity:1}to{opacity:0;-webkit-transform:translate3d(0,-100%,0);transform:translate3d(0,-100%,0)}}@keyframes fadeOutUp{from{opacity:1}to{opacity:0;-webkit-transform:translate3d(0,-100%,0);transform:translate3d(0,-100%,0)}}.fadeOutUp{-webkit-animation-name:fadeOutUp;animation-name:fadeOutUp}.form-control{display:block;width:90%;margin-left:5%;height:34px;padding:6px 12px;font-size:14px;line-height:1.42857143;color:#555;background-color:#fff;background-image:none;border:1px solid #ccc;border-radius:4px;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075);box-shadow:inset 0 1px 1px rgba(0,0,0,.075);-webkit-transition:border-color ease-in-out .15s,-webkit-box-shadow ease-in-out .15s;-o-transition:border-color ease-in-out .15s,box-shadow ease-in-out .15s;transition:border-color ease-in-out .15s,box-shadow ease-in-out .15s}.form-control:focus{border-color:#66afe9;outline:0;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6);box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6)}
	</style>

</head>
<body>

	<div id="container" class="v-mid"></div>

	<script type="text/babel">
		var Time = React.createClass({
			timeFormat: function(t) {
				return t < 10 ? "0"+t : t;
			},
			render: function() {
				return (
					<div id="now" className="animated infinite">
						{this.timeFormat(this.props.min)}  :  {this.timeFormat(this.props.sec)}
					</div>
				);
			}
		});

		var countTimer;
		var options = [];
		for( var i = 0; i < 60; i++ ) {
			options.push( <option value={i}>{i}</option> );
		}

		var Minutes = React.createClass({
			render: function() {
				return (
					<select id="min" className="form-control" onChange={this.props.onChange}>
						{options}
					</select>
				);
			}
		});

		var Seconds = React.createClass({
			render: function() {
				return (
					<select id="sec" className="form-control" onChange={this.props.onChange}>
						{options}
					</select>
				);
			}
		});

		var Card = React.createClass({
			render: function() {
				return (
					<div id="card" className="animated">
						<div className="title">SET TIMER</div>
						<h5>MINUTES:</h5>
						<Minutes onChange={this.props.onMinutesChange} />
						<h5>SECONDS:</h5>
						<Seconds onChange={this.props.onSecondsChange} />
						<div className="btn" onClick={this.props.timerStart}>GO</div>
					</div>
				);
			}
		});

		var Timer = React.createClass({
			getInitialState: function() {
				return { minutes: 0, seconds: 0, total: 0 };
			},
			handleMinutesChange: function(e) {
				this.setState({ minutes: e.target.value });
			},
			handleSecondsChange: function(e) {
				this.setState({ seconds: e.target.value });
			},
			startTimer: function() {
				if( this.state.minutes == 0 && this.state.seconds == 0 )
					alert('請設定時間');
				else {
					this.setState({ total: parseInt(this.state.minutes*60)+parseInt(this.state.seconds) });
					countTimer = setInterval( function(){
						var newTotal = this.state.total-1

						this.setState({
							minutes: Math.floor(newTotal/60),
							seconds: newTotal%60,
							total: this.state.total-1
						});

						if( newTotal == 0 ) {
							clearInterval( countTimer );
							document.getElementById('now').className += ' shake';
							document.title = "Time\'s up !!";
							setInterval( function() {
								document.body.style.backgroundColor = '#F44336';
								document.title = "React Timer";
								setTimeout( function() {
									document.body.style.backgroundColor = 'white';
								}, 500);
							}, 1000);
						}
					}.bind(this), 1000);

					document.getElementById('card').className += ' fadeOutUp';
				}
			},
			render: function() {
				return (
					<div>
						<Time min={this.state.minutes} sec={this.state.seconds} />
						<Card onMinutesChange={this.handleMinutesChange} onSecondsChange={this.handleSecondsChange} timerStart={this.startTimer} />
					</div>
				);
			}
		});

		ReactDOM.render(
			<Timer />, document.getElementById('container')
		);
	</script>

</body>
</html>
